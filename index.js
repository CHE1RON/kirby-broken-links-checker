(function(){"use strict";const w="";function k(e,t,n,i,l,h,c,o){var r=typeof e=="function"?e.options:e;t&&(r.render=t,r.staticRenderFns=n,r._compiled=!0),i&&(r.functional=!0),h&&(r._scopeId="data-v-"+h);var s;if(c?(s=function(a){a=a||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!a&&typeof __VUE_SSR_CONTEXT__<"u"&&(a=__VUE_SSR_CONTEXT__),l&&l.call(this,a),a&&a._registeredComponents&&a._registeredComponents.add(c)},r._ssrRegister=s):l&&(s=o?function(){l.call(this,(r.functional?this.parent:this).$root.$options.shadowRoot)}:l),s)if(r.functional){r._injectStyles=s;var u=r.render;r.render=function(C,f){return s.call(f),u(C,f)}}else{var d=r.beforeCreate;r.beforeCreate=d?[].concat(d,s):[s]}return{exports:e,options:r}}const _={props:{base:String,urls:{type:Array,default:[]}},computed:{linksCount(){return this.urls.length},errorsCount(){return this.urls.filter(e=>e.status!==200).length}},methods:{addToUrls(e,t,n=null,i=null){if(this.isChecked(e)===!1){n&&(n={text:n.replace(this.base,"")||"/",href:n});const l={url:{text:e.replace(this.base,"")||"/",href:e},code:t,status:t===200?"\u{1F7E2}":"\u{1F534}",source:n,link:i,date:new Date().toLocaleString()};t===200?this.urls.push(l):this.urls.unshift(l)}},async crawlUrl(e,t=null,n=null){if(this.isChecked(e)===!0)return!1;await fetch(e).then(async i=>{const l=await i.text();if(this.addToUrls(e,i.status,t,n),this.isWebpage(i)!==!0)return!1;const o=new DOMParser().parseFromString(l,"text/html").documentElement.querySelectorAll("a");for(let r=0;r<o.length;r++){let s=o[r].getAttribute("href"),u=o[r].innerHTML;this.isInternal(s)===!0&&await this.crawlUrl(s,e,u)}}).catch(i=>{this.addToUrls(e,i.code,t)})},isInternal(e){return e.startsWith(this.base)},isChecked(e){return this.urls.filter(t=>t.url.href===e).length>0},isWebpage(e){var t,n;return(n=(t=e==null?void 0:e.headers)==null?void 0:t.get("content-type"))==null?void 0:n.startsWith("text/html")}}};var p=function(){var t=this,n=t._self._c;return n("k-inside",[n("k-view",{staticClass:"k-broken-links-checker-view"},[n("header",{staticClass:"k-header k-broken-links-checker-view-header"},[n("h2",[t._v("Broken links checker")]),n("k-button",{attrs:{tooltip:"Scan now",text:"Scan now",icon:"search"},on:{click:function(i){return t.crawlUrl(t.base)}}})],1),n("section",{staticClass:"k-broken-links-checker-view-section"},[n("header",[n("k-headline",[t._v("Checked URLs ("+t._s(t.linksCount)+") | Errors found: ("+t._s(t.errorsCount)+") ")])],1),n("k-table",{attrs:{columns:{url:{label:"Link",type:"url",mobile:!0},code:{label:"Code",width:"1/20"},status:{label:"Status",width:"1/20"},source:{label:"Source",type:"url",width:"5/20"},link:{label:"Link content",type:"html",width:"5/20"}},rows:t.urls,empty:"No links checked yet"}})],1)])],1)},b=[],m=k(_,p,b,!1,null,null,null,null);const v=m.exports;panel.plugin("ahmetbora/broken-links-checker",{components:{BrokenLinksChecker:v}})})();
